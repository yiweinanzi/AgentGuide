const c="ig-question-progress-v1",s={favoriteIds:[],completedIds:[]};function i(e){if(typeof window>"u")return null;try{return window.localStorage}catch{return null}}function a(e){if(!Array.isArray(e))return[];const r=new Set,t=[];for(const o of e){if(typeof o!="string")continue;const n=o.trim();!n||r.has(n)||(r.add(n),t.push(n))}return t}function u(e){if(!e||typeof e!="object")return{...s};const r=e;return{favoriteIds:a(r.favoriteIds),completedIds:a(r.completedIds)}}function d(e,r){const t=r.trim();return t?e.includes(t)?e.filter(o=>o!==t):[...e,t]:e}function f(e){const r=i();if(!r)return{...s};try{const t=r.getItem(c);return t?u(JSON.parse(t)):{...s}}catch{return{...s}}}function l(e,r){const t=u(e),o=i();if(!o)return t;try{o.setItem(c,JSON.stringify(t))}catch{}return t}function m(e,r){const t=f();return l({favoriteIds:d(t.favoriteIds,e),completedIds:t.completedIds})}function I(e,r){const t=f();return l({favoriteIds:t.favoriteIds,completedIds:d(t.completedIds,e)})}function S(e,r){const t=Math.max(0,e),o=r.completedIds.length,n=r.favoriteIds.length,g=t===0?0:Math.round(o/t*100);return{favoriteCount:n,completedCount:o,completionRate:g}}export{I as a,S as g,f as l,m as t};
